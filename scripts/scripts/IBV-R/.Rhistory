rownames(metadata_df) <- metadata
references <- metadata_df[grepl("B/", metadata_df$metadata), ]
ref_df <- as.data.frame(references)
ref_df$references <- gsub("'", "", ref_df$references)
ref_df <- ref_df %>% separate(references, c("sample_id","Lineage", "segment", "clade", "collection_date"), sep = "\\|")
#ref_df <- ref_df %>% separate(references, c("sample_id","Lineage", "clade"), sep = "\\|")
ref_df <- ref_df %>% separate(collection_date, c("year", "month", "date"), sep = "-")
#ref_df <- ref_df %>% separate(sample_id, c("subtype", "country", "version" , "year"), sep = "/")
rownames(ref_df) <- references
samples <- metadata_df[!grepl("B/", metadata_df$metadata), ]
sample_df <- as.data.frame(samples)
sample_df$samples <- gsub("'", "", sample_df$samples)
sample_df <- sample_df %>% separate(samples, c("sample_id", "Location","collection_date"), sep = "\\|")
sample_df <- sample_df %>% separate(collection_date, c("year", "month", "date"), sep = "-")
sample_df$year <- gsub("9/1/2020","2020", sample_df$year)
sample_df$year <- gsub("11/11/2019","2019", sample_df$year)
sample_df$year <- gsub("2/11/2021","2021", sample_df$year)
rownames(sample_df) <- samples
mdata <- bind_rows(ref_df, sample_df)
mdata <- mdata[rownames(metadata_df), ]
mdata$label <- rownames(metadata_df)
mdata$Location <- as.factor(mdata$Location)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=206, label="Yamagata", offset = .025) +
geom_cladelabel(node=112, label="Y1", offset = .0455) +
geom_cladelabel(node=219, label="Y2", offset = .036) +
geom_cladelabel(node=208, label="Y3", offset = .02) +
geom_cladelabel(node=92, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=116, label="V1A", offset = .02) +
geom_cladelabel(node=198, label="V1A.1", offset = .028) +
geom_cladelabel(node=79, label="V1A.2", offset = .028) +
geom_cladelabel(node=185, label="V1A.3", offset = .0195) +
geom_cladelabel(node=183, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=123, label="V1A.3a.2", offset = .013) +
ggtitle("HA segment") +
#geom_text(aes(label=node), hjust=-.3, size = 5) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=206, label="Yamagata", offset = .025) +
geom_cladelabel(node=112, label="Y1", offset = .0455) +
geom_cladelabel(node=219, label="Y2", offset = .036) +
geom_cladelabel(node=208, label="Y3", offset = .02) +
geom_cladelabel(node=92, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=116, label="V1A", offset = .02) +
geom_cladelabel(node=198, label="V1A.1", offset = .028) +
geom_cladelabel(node=79, label="V1A.2", offset = .028) +
geom_cladelabel(node=185, label="V1A.3", offset = .0195) +
geom_cladelabel(node=183, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=123, label="V1A.3a.2", offset = .013) +
ggtitle("HA segment") +
geom_text(aes(label=node), hjust=-.3, size = 5) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=40, label="V1A.3", offset = .0195) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
ggtitle("HA segment") +
#geom_text(aes(label=node), hjust=-.3, size = 5) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=40, label="V1A.3", offset = .0195) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
ggtitle("HA segment") +
geom_text(aes(label=node), hjust=-.3, size = 5) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=40, label="V1A.3", offset = .0195) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
ggtitle("HA segment") +
geom_text(aes(label=node), hjust=-.3, size = 3) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=149, label="V1A.3", offset = .0195) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
ggtitle("HA segment") +
geom_text(aes(label=node), hjust=-.3, size = 3) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=149, label="V1A.3", offset = .02) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
ggtitle("HA segment") +
#geom_text(aes(label=node), hjust=-.3, size = 3) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=149, label="V1A.3", offset = .025) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
ggtitle("HA segment") +
#geom_text(aes(label=node), hjust=-.3, size = 3) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=149, label="V1A.3", offset = .024) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
ggtitle("HA segment") +
#geom_text(aes(label=node), hjust=-.3, size = 3) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=149, label="V1A.3", offset = .024) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
geom_nodelab(
mapping = aes(
x = branch,
label = label,
subset = !is.na(as.numeric(label)) & as.numeric(label) > 70)) +
ggtitle("HA segment") +
#geom_text(aes(label=node), hjust=-.3, size = 3) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=149, label="V1A.3", offset = .024) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
geom_nodelab(
mapping = aes(
x = branch,
label = label,
subset = !is.na(as.numeric(label)) & as.numeric(label) > 70), size=1) +
ggtitle("HA segment") +
#geom_text(aes(label=node), hjust=-.3, size = 3) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=149, label="V1A.3", offset = .024) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
geom_nodelab(
mapping = aes(
x = branch,
label = label,
subset = !is.na(as.numeric(label)) & as.numeric(label) > 70), size=2) +
ggtitle("HA segment") +
#geom_text(aes(label=node), hjust=-.3, size = 3) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
HA_treeplot <- ggtree(HA_tree, size = 0.2) +
geom_tiplab(size = 2,  aes(color = ifelse(grepl("KCH", label), "KCH",
ifelse(grepl("Matsangoni", label), "Matsangoni",
ifelse(grepl("Ngerenya", label), "Ngerenya",
ifelse(grepl("Mavueni", label), "Mavueni",
ifelse(grepl("Mtondia", label), "Mtondia",
ifelse(grepl("Pingilikani", label), "Pingilikani",
ifelse(grepl("Jinja", label), "Jinja",
ifelse(grepl("Soroti", label), "Soroti",
ifelse(grepl("Mbale", label), "Mbale",                                                                                                                "Reference")))))))))), show.legend= FALSE) +
scale_color_manual(name = "Location",
values = c("KCH" = "blue", "Matsangoni" = "red2", "Mavueni"= "darkorchid3", "Mtondia" =                                           "darkgreen", "Pingilikani" = "coral4", "Jinja" = "orchid4", "Soroti" = "maroon3", "Mbale" =                                           "orange", "Reference" = "black")) +
geom_cladelabel(node=114, label="Victoria", offset = .025) +
geom_cladelabel(node=115, label="Yamagata", offset = .025) +
geom_cladelabel(node=3, label="Y1", offset = .0455) +
geom_cladelabel(node=117, label="Y2", offset = .036) +
geom_cladelabel(node=122, label="Y3", offset = .02) +
geom_cladelabel(node=1, label="V1B", offset = .043) +
#geom_cladelabel(node=93, label="V1A", offset = .049) +
geom_cladelabel(node=223, label="V1A", offset = .02) +
geom_cladelabel(node=210, label="V1A.1", offset = .028) +
geom_cladelabel(node=105, label="V1A.2", offset = .028) +
geom_cladelabel(node=149, label="V1A.3", offset = .024) +
geom_cladelabel(node=215, label="V1A.3a.1", offset = .022) +
geom_cladelabel(node=156, label="V1A.3a.2", offset = .013) +
geom_nodelab(
mapping = aes(
x = branch,
label = label,
subset = !is.na(as.numeric(label)) & as.numeric(label) > 70), size=2, vjust=-0.2) +
ggtitle("HA segment") +
#geom_text(aes(label=node), hjust=-.3, size = 3) +
theme_classic() +
scale_y_continuous(breaks = seq(0, 300, 50)) +
theme(panel.grid.major = element_line(colour = "grey", linetype = "dashed", linewidth = 0.2),
plot.title = element_text(
size = 12,
face = "bold",
hjust = 0.5),
legend.position = "none")
HA_treeplot +  xlim(0, 0.12)
rm(list=ls())
setwd("~/Desktop/Msc/scripts/IBV-R")
