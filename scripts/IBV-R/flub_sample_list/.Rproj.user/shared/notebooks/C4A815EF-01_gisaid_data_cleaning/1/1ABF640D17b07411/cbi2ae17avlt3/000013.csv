"0",""
"0","# Separate the collection date column "
"0","#vic_gisaid <- vic_gisaid %>% separate(collection_date, c(""year"", ""month"", ""date""), sep = ""-"")"
"0","#yam_gisaid <- yam_gisaid %>% separate(collection_date, c(""year"", ""month"", ""date""), sep = ""-"")"
"0",""
"0","#Subsample the vic dataset"
"0",""
"0","subsample <- function (subsample_continent, subsample_year, subsample_month) {"
"0","  gisaid1 <- filter(vic_gisaid, segment == ""HA"" & as.numeric(year) == subsample_year & continent == subsample_continent & as.numeric(month) == subsample_month)"
"0","  num_rows <- nrow(gisaid1)"
"0","  num_samples <- min(num_rows, 10)"
"0","  "
"0","  if (num_samples > 0) {"
"0","    data_subsample <- sample(gisaid1$isolate_id, num_samples)"
"0","    dataset_subsampled <- vic_gisaid[vic_gisaid$isolate_id %in% data_subsample, ]"
"0","    return(dataset_subsampled)"
"0","  } else {"
"0","    return(NULL)  # Return NULL if there are no samples to subsample"
"0","  }"
"0","}"
"0",""
"0","continents <- c(""Africa "", ""Europe "", ""Asia "", ""Oceania "", ""South America "", ""North America "")"
"0","years <- c(1987:2023)"
"0","months <- c(01, 02, 03, 04, 05, 06, 07, 08, 09, 10, 11, 12)"
"0",""
"0","writeFasta <- function(data, filename) {"
"0","  fastaLines <- c()"
"0","  for (rowNum in 1:nrow(data)) {"
"0","    fastaLines <- c(fastaLines, as.character(paste("">"", data[rowNum, ""header""], sep = """")))"
"0","    fastaLines <- c(fastaLines, as.character(data[rowNum, ""sequences""]))"
"0","  }"
"0","  fileConn <- file(filename)"
"0","  writeLines(fastaLines, fileConn)"
"0","  close(fileConn)"
"0","}"
"0",""
"0","# Assuming vic_gisaid dataset is loaded or generated correctly"
"0",""
"0","for (continent in continents) {"
"0","  for (year in years) {"
"0","    for (month in months) {"
"0","      # Call your subsample function with the current continent and year"
"0","      subsample_data <- subsample(continent, year, month)"
"0","      "
"0","      if (!is.null(subsample_data)) {"
"0","        subsample_data <- unite(subsample_data, collection_date, c(year, month, date), sep = ""-"")"
"0","        subsample_data <- unite(subsample_data, header, c(isolate_name, isolate_id, country, lineage, segment, collection_date), sep = '|')"
"0","        "
"0","        file_name <- paste0(""~/Desktop/Msc/data/gisaid/vic_totalsubsamp/"", continent, ""_"", year, month, "".fasta"")"
"0","        writeFasta(subsample_data, file_name)"
"0","      }"
"0","    }"
"0","  }"
"0","}"
"0",""
