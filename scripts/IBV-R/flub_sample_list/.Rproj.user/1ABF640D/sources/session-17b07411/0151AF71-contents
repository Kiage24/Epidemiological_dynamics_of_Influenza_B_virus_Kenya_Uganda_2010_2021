---
title: "glycosylation"
author: "Brenda_Kiage"
date: "2023-05-31"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```


```{r load the required libraries}
library(dplyr)
library(tidyr)
library(stringr)
library(gridExtra)
```



```{r read in the data and extract glycosylation sites}

# Read in the nextclade metadata
nextclade_metadata <- read.csv("~/Desktop/Msc/flub_results/nextclade/NA_victotal.csv", sep = ";")

#Obtain the names, clade and aa_substitutions
glycosylation_sites <- cbind(nextclade_metadata$seqName, nextclade_metadata$clade, nextclade_metadata$glycosylation)
vic_ha_sites <- as.data.frame(glycosylation_sites)
colnames(vic_ha_sites) <- c("seqname", "clade","glycosylation")

#Transform the substitution column to obtain the  domain
vic_ha_sites<- separate_rows(vic_ha_sites, glycosylation, sep = ";")
vic_ha_sites <-vic_ha_sites %>% separate(glycosylation, c("domain", "position", "codon"), sep = ":")

# Transform the dataframe for analysis
vicha_sites_df <- pivot_wider(vic_ha_sites, names_from = position, values_from = codon)
write_csv(vicha_sites_df, "~/Desktop/Msc/flub_results/glycosylation/vic_natotal_glycosylations.csv")


```



```{r extract yamagata glycosylation sites}

# Read in the nextclade metadata
nextclade_metadata <- read.csv("~/Downloads/yamha_nextclade.csv", sep = ";")


#Obtain the names, clade and aa_substitutions
yamglycosylation_sites <- cbind(nextclade_metadata$seqName, nextclade_metadata$clade)
yam_ha_sites <- as.data.frame(yamglycosylation_sites)
colnames(yam_ha_sites) <- c("seqname", "clade")

#Transform the substitution column to obtain the  domain
yam_ha_sites<- separate_rows(yam_ha_sites, glycosylation, sep = ";")
yam_ha_sites <-yam_ha_sites %>% separate(glycosylation, c("domain", "position", "codon"), sep = ":")

# Transform the dataframe for analysis
yamha_sites_df <- pivot_wider(yam_ha_sites, names_from = position, values_from = codon)
write_csv(yam_ha_sites, "~/Desktop/Msc/flub_results/glycosylation/yam_ha_glycosylations.csv")

```





